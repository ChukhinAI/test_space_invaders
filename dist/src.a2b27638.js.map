{"version":3,"sources":["src/sprite.js","src/cannon.js","src/bullet.js","src/alien.js","src/bunker.js","src/input-handler.js","src/game.js","src/index.js","node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["Sprite","img","x","y","w","h","scX","scY","scaleX","scaleY","Cannon","sprite","_sprite","lives","ctx","time","drawImage","Bullet","vy","color","dir","cnvsHeight","fillStyle","fillRect","Alien","spriteA","spriteB","_spriteA","_spriteB","mooving","steps","lastSecondMove","count","shouldShoot","Math","random","undefined","sp","ceil","second","shouldMoveHorizontal","shouldMoveDown","Bunker","font","fillText","InputHandler","down","pressed","document","addEventListener","e","keyCode","code","canvas","getElementById","assets","sprites","aliens","cannon","bunker","cannonShield","gameState","bullets","bunkers","alienBullets","score","inputHandler","sleep","ms","Promise","resolve","setTimeout","preload","onPreloadComplete","Image","src","assetPath","classicFormation","alienTypes","i","len","length","j","alienType","alienX","alienY","push","svinfylkingFormation","split","init","bunkerX","height","update","stopGame","isDown","width","isPressed","bulletX","bulletY","forEach","b","self","splice","alien","index","bullet","shoot","move","collisionCheck","draw","showLoseScreen","showWinScreen","getContext","clearRect","a","drawInfo","textAlign","textBaseline","rectIntersection","r1","r2","leftX","max","rightX","min","topY","botY","activateShield","lineWidth","arc","PI","console","log","strokeStyle","stroke","gameOver","getBoundingRect","alienBullet","cB","aB","window","innerWidth","innerHeight","tickLength","lastTick","lastRender","stopCycle","run","tFrame","requestAnimationFrame","nextTick","numTicks","timeSinceTick","floor","cancelAnimationFrame","performance","now","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["export default class Sprite {\n  constructor(img, x, y, w, h, scX, scY) {\n    this.img = img;\n  \t// this.x = (x + x + 1) / 2 - 1/2; // +1\n    this.x = x + 2;\n  \tthis.y = y + 3;\n  \tthis.w = w;\n  \tthis.h = h;\n    this.scaleX = scX;\n    this.scaleY = scY;\n  }\n}\n","export default class Cannon {\n  constructor(x, y, sprite) {\n    this.x = x;\n  \tthis.y = y;\n    this._sprite = sprite;\n    this.lives = 3;\n  }\n\n  draw(ctx, time) {\n    ctx.drawImage(\n      this._sprite.img,\n      this._sprite.x, this._sprite.y, this._sprite.w, this._sprite.h,\n      this.x * this._sprite.scaleX, this.y, this._sprite.w * this._sprite.scaleX, this._sprite.h * this._sprite.scaleY\n    );\n  }\n  \n  getBoundingRect()\n  {\n    return {x: this.x * this._sprite.scaleX, y: this.y, w: this._sprite.w * this._sprite.scaleX,\n            h: this._sprite.h * this._sprite.scaleY};\n  }\n}\n","export default class Bullet {\n  constructor(x, y, vy, w, h, color) {\n    this.x = x;\n  \tthis.y = y;\n  \tthis.vy = vy;\n  \tthis.w = w;\n  \tthis.h = h;\n  \tthis.color = color;\n  }\n\n  update(dir, cnvsHeight) {\n      if (dir)\n        this.y += this.vy;\n      else\n        this.y -= this.vy;\n      if (this.y > cnvsHeight || this.y + this.w < 0)\n          return true;\n      return false;\n  }\n\n  draw(ctx) {\n    ctx.fillStyle = this.color;\n  \tctx.fillRect(this.x, this.y, this.w, this.h);\n  }\n  \n  getBoundingRect()\n  {\n    return {x: this.x, y: this.y, w: this.w, h: this.h};\n  }\n}\n","import Bullet from './bullet'\n\nexport default class Alien {\n  constructor(x, y, [spriteA, spriteB]) {\n    this.x = x;\n  \tthis.y = y;\n    this._spriteA = spriteA;\n    this._spriteB = spriteB;\n    //this.moveDir = false; // left\n    this.mooving = false;\n    this.steps = 1;\n    this.lastSecondMove = 0;\n  }\n\n    shoot(count) {\n        let shouldShoot = Math.random() < 1 / count / 6;\n        if (shouldShoot)\n        {\n            return new Bullet((this.x + this._spriteA.w / 2) * this._spriteA.scaleX, (this.y + this._spriteA.h) * this._spriteA.scaleY, -2, 2, 2, \"yellow\")\n        }\n        return undefined;\n    }\n\n  draw(ctx, time) {\n    let sp = (Math.ceil(time / 1000) % 2 === 0) ? this._spriteA : this._spriteB;\n\n    ctx.drawImage(\n      sp.img,\n      sp.x, sp.y, sp.w, sp.h,\n      this.x * sp.scaleX, this.y * sp.scaleY, sp.w * sp.scaleX, sp.h * sp.scaleY\n    );\n  }\n    move(time) {\n        let second = Math.ceil(time / 1000)\n        if (second == this.lastSecondMove)\n            return;\n        this.lastSecondMove = second\n        let shouldMoveHorizontal = (second % 2 === 0);\n        let shouldMoveDown = (second % 5 === 0);\n        if (shouldMoveHorizontal)\n        {\n            //if (this.moveDir) // mooving\n            if (this.mooving)\n            {\n                this.x += 20;\n            }\n            else\n            {\n                this.x -= 20;\n            }\n            this.steps--;\n            if (this.steps == 0)\n            {\n                //this.moveDir = !this.moveDir\n                this.mooving = !this.mooving\n                this.steps = 2\n            }\n        }\n        if (shouldMoveDown)\n        {\n            this.y += 10;\n        }\n    }\n\n  getBoundingRect()\n  {\n    let sp = this._spriteA;\n    return {x: this.x * sp.scaleX, y: this.y * sp.scaleY, w: sp.w * sp.scaleX, h: sp.h * sp.scaleY};\n  }\n}\n","export default class Bunker {\n  constructor(x, y, sprite) {\n    this.x = x;\n  \tthis.y = y;\n    this._sprite = sprite;\n    this.lives = 20;\n  }\n\n  getBoundingRect() {\n    return {x: (this.x) * this._sprite.scaleX, y: this.y, w: this._sprite.w * this._sprite.scaleX,\n      h: this._sprite.h * this._sprite.scaleY};\n  }\n\n  draw(ctx, time) {\n    ctx.drawImage(\n      this._sprite.img,\n      this._sprite.x, this._sprite.y, this._sprite.w, this._sprite.h , //this._sprite.h + 10,this._sprite.y - 10\n        this.x * this._sprite.scaleX, this.y, this._sprite.w *\n        this._sprite.scaleX, this._sprite.h * this._sprite.scaleY\n    );\n\n    ctx.fillStyle = \"yellow\";\n    ctx.font = \"22px Arial, jet-brains mono\";\n    ctx.fillText(this.lives, \n                 this.x * this._sprite.scaleX + this._sprite.w * this._sprite.scaleX / 2 - 10,\n                 this.y - 40);\n  }\n}\n","export default class InputHandler {\n  constructor() {\n    this.down = {};\n  \tthis.pressed = {};\n  \tdocument.addEventListener(\"keydown\", e => {\n  \t\tthis.down[e.keyCode] = true;\n  \t});\n  \tdocument.addEventListener(\"keyup\", e => {\n  \t\tdelete this.down[e.keyCode];\n  \t\tdelete this.pressed[e.keyCode];\n  \t});\n  }\n\n  /**\n   * Returns whether a key is pressod down\n   * @param  {number} code the keycode to check\n   * @return {bool} the result from check\n   */\n  isDown(code) {\n  \treturn this.down[code];\n  }\n\n  /**\n   * Return wheter a key has been pressed\n   * @param  {number} code the keycode to check\n   * @return {bool} the result from check\n   */\n  isPressed(code) {\n  \t// if key is registred as pressed return false else if\n  \t// key down for first time return true else return false\n  \tif (this.pressed[code]) {\n  \t\treturn false;\n  \t} else if (this.down[code]) {\n  \t\treturn this.pressed[code] = true;\n  \t}\n  \treturn false;\n  }\n}\n","import Sprite from './sprite'\nimport Cannon from './cannon'\nimport Bullet from './bullet'\nimport Alien from './alien'\nimport Bunker from './bunker'\nimport InputHandler from './input-handler'\n\n\n//import assetPath from '../assets/invaders_m_4.png'\nimport assetPath from '../assets/14_2.png'\nconst canvas = document.getElementById(\"cnvs\");\n\n//let ctx = canvas.getContext('2d'); // ACHTUNG!\n\nlet assets;\nconst sprites = {\n    aliens: [],\n    cannon: null,\n    bunker: null,\n    cannonShield: null\n};\nconst gameState = {\n    bullets: [],\n    aliens: [],\n    bunkers: [],\n    alienBullets: [],\n    cannon: null,\n    score: 0\n};\nconst inputHandler = new InputHandler();\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport function preload(onPreloadComplete) {\n    //  It was at this moment I knew: I fckd up\n\n     // sleep(2000);\n    //setTimeout(() => {  console.log(\"World!\"); }, 20000);\n\n    assets = new Image();\n    assets.addEventListener(\"load\", () => {\n        let scaleX = 2;\n        let scaleY = 2;\n        sprites.cannon = new Sprite(assets, 63, 0, 20, 32, scaleX, scaleY); // оригинал\n        sprites.cannonShield = new Sprite(assets, 120, 3, 38, 42, scaleX, scaleY);\n\n        sprites.bunker = new Sprite(assets, 84, 8, 35, 24, scaleX, scaleY);\n        sprites.aliens = [\n            [new Sprite(assets,  0, 0, 22, 16, scaleX, scaleY),\n             new Sprite(assets,  0, 16, 22, 16, scaleX, scaleY)],\n\n            [new Sprite(assets, 23, 0, 14, 16, scaleX, scaleY),\n             new Sprite(assets, 23, 16, 14, 16, scaleX, scaleY)],\n\n            [new Sprite(assets, 38, 0, 24, 16, scaleX, scaleY),\n             new Sprite(assets, 38, 16, 24, 16, scaleX, scaleY)]\n        ]\n        \n        onPreloadComplete();\n    });\n    assets.src = assetPath;\n}\n\nfunction classicFormation()\n{\n    const alienTypes = [0, 1, 2];\n    for (let i = 0, len = alienTypes.length; i < len; i++) {\n        for (let j = 0; j < 22; j++) {\n            const alienType = alienTypes[i];\n            \n            let alienX = 28 + j*28;\n            let alienY = 28 + i*28; // 30 + i*30;\n            \n            if (alienType === 1) {\n                alienX += 3; // aliens of this type is a bit thinner\n            }\n            \n            gameState.aliens.push(\n                new Alien(alienX, alienY, sprites.aliens[alienType])\n            );\n        }\n    }\n}\n\nfunction svinfylkingFormation()\n{\n    const alienTypes = [0, 1, 2];\n    let split = 2; //2\n    for (let i = 0; i < 5; i++) {\n        for (let j = -2 + split; j < 22 - split; j++) {\n            const alienType = alienTypes[i % 3];\n            \n            let alienX = 28 + j*28;\n            let alienY = 28 + i*28;\n            \n            if (alienType === 1) {\n                alienX += 3; // aliens of this type is a bit thinner\n            }\n            \n            gameState.aliens.push(\n                new Alien(alienX, alienY, sprites.aliens[alienType])\n            );\n        }\n        split+=2;\n    }\n}\n\nexport function init(canvas) {\n    if (Math.random() < 0.5)\n        svinfylkingFormation();\n    else\n        classicFormation();\n    \n    for (let j = 0; j < 8; j++) {\n        \n        let bunkerX = 28 + j*90;\n        \n        gameState.bunkers.push(\n            new Bunker(bunkerX, canvas.height - 250, sprites.bunker)\n        );\n    }\n    \n    gameState.cannon = new Cannon(\n        100, canvas.height - 100,\n        sprites.cannon\n    );\n}\n\nexport function update(time, stopGame) {\n    if (inputHandler.isDown(37)) { // Left\n        if (gameState.cannon.x - 4 >= 0) // somehow works\n            gameState.cannon.x -= 4; \n    }\n    \n    if (inputHandler.isDown(39)) { // Right\n        if ((gameState.cannon.x + 4 + gameState.cannon._sprite.w) * gameState.cannon._sprite.scaleX <= canvas.width)\n            gameState.cannon.x += 4;\n    }\n    \n    if (inputHandler.isPressed(32)) { // Space\n        const bulletX = (gameState.cannon.x + gameState.cannon._sprite.w / 2) * gameState.cannon._sprite.scaleX\n        const bulletY = gameState.cannon.y;\n        gameState.bullets.push(new Bullet(bulletX, bulletY, -8, 2, 6, \"#fff\"));\n    }\n\n    gameState.bullets.forEach((b, i, self) => {\n        if (b.update(true, canvas.height))\n            self.splice(i, 1);\n        \n    })\n    \n    gameState.alienBullets.forEach((b, i, self) => {\n        if (b.update(false, canvas.height))\n            self.splice(i, 1);\n    })\n    \n    gameState.aliens.forEach((alien, index, self) => {\n        let bullet = alien.shoot(self.length);\n        if (bullet !== undefined)\n            gameState.alienBullets.push(bullet)\n        alien.move(time)\n    });\n    \n    if (collisionCheck())\n    {\n        draw = showLoseScreen; // aliens win(\n        stopGame();\n    }\n    \n    if (gameState.aliens.length == 0)\n    {\n        draw = showWinScreen; // humans win))\n        stopGame();\n    } \n}\n\nfunction showLoseScreen()\n{\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.font = \"100px Arial, sans-serif\";\n    ctx.fillText(\"Gameover!\", canvas.width / 2 - 300, canvas.height / 2 - 200);\n    ctx.fillText(\"Final score: \" + gameState.score, canvas.width / 2 - 300, canvas.height / 2 + 120 - 200);\n}\n\nfunction showWinScreen()\n{\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.font = \"100px Arial, sans-serif\";\n    ctx.fillText(\"You win!\", canvas.width / 2 - 300, canvas.height / 2 - 200);\n    ctx.fillText(\"Your score: \" + gameState.score, canvas.width / 2 - 300, canvas.height / 2 + 120 - 200);\n}\n\nexport let draw = function draw(canvas, time) {\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    \n    gameState.aliens.forEach(a => a.draw(ctx, time));\n    gameState.cannon.draw(ctx);\n    gameState.cannonShield.draw(ctx);\n    gameState.bullets.forEach(b => b.draw(ctx));\n    gameState.bunkers.forEach(b => b.draw(ctx));\n    gameState.alienBullets.forEach(b => b.draw(ctx));\n    drawInfo(ctx)\n}\n\nfunction drawInfo(ctx)\n{\n    ctx.fillStyle = \"#9FFF9F\";\n    ctx.fillRect(0, 50, ctx.width, 10);\n    \n    \n    ctx.font = \"24px Arial, sans-serif\";\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"top\";\n    ctx.fillText(\"Score: \" + gameState.score + \"    Shields: \" + gameState.cannon.lives, 20, 20 );\n}\n\nfunction rectIntersection(r1, r2)\n{\n     const leftX = Math.max(r1.x, r2.x);\n     const rightX = Math.min(r1.x + r1.w, r2.x + r2.w);\n     const topY = Math.max(r1.y,r2.y);\n     const botY =  Math.min(r1.y + r1.h, r2.y + r2.h);\n     if ((rightX > leftX) && (botY > topY)) {\n         return true;\n     }\n     return false;\n}\n\nfunction activateShield() // в данный момент выпилена\n{\n    const ctx = canvas.getContext('2d');\n\n    let cannon = gameState.cannon;\n\n    //ctx.clearRect(0, 0, canvas.width, canvas.height); // achtung\n\n    ctx.lineWidth = 50; // толщина линии\n\n    //ctx.arc(cannon.x,cannon.y,300,0, Math.PI,true);\n    ctx.arc(300, 700,200,0, Math.PI,true);\n    console.log('y=', cannon.y)\n    ctx.strokeStyle = 'red';\n    ctx.fillStyle = \"orange\";\n    ctx.stroke();\n    console.log('est probitie');\n}\n\nfunction collisionCheck()\n{\n    let bullets = gameState.bullets;\n    let alienBullets = gameState.alienBullets;\n    let bunkers = gameState.bunkers;\n    let aliens = gameState.aliens;\n    let cannon = gameState.cannon;\n    let gameOver = false;\n\n\n    bullets.forEach((bullet, i, bullets) => {\n        aliens.forEach((alien, j, aliens) => {\n           if (rectIntersection(bullet, alien.getBoundingRect()))\n           {\n                bullets.splice(i, 1);\n                aliens.splice(j, 1);\n                gameState.score += 50;\n           }\n        });\n    });\n        \n    alienBullets.forEach((alienBullet, i, alienBullets) => {\n        if (rectIntersection(alienBullet, cannon.getBoundingRect()))\n        {\n            alienBullets.splice(i, 1);\n            cannon.lives--;\n\n            //activateShield(); // пусть хоть 1-2 секунды будет активирован, найти как это сделать// изменил стратегию\n\n            if (cannon.lives <= 0)\n            {\n                gameOver = true;\n            }\n        }\n        \n        bunkers.forEach((bunker, j, bunkers) => {\n           if (rectIntersection(bunker.getBoundingRect(), alienBullet.getBoundingRect()))\n           {\n                alienBullets.splice(i, 1);\n                bunker.lives--;\n                if (bunker.lives <= 0)\n                {\n                    bunkers.splice(j, 1);\n                }\n           }\n        });\n    });\n    \n    aliens.forEach((alien, i, aliens) => {\n        let cB = cannon.getBoundingRect()\n        let aB = alien.getBoundingRect()\n        if (aB.y + aB.h > cB.y)\n        {\n            gameOver = true;\n        }\n        \n        bunkers.forEach((bunker, j, bunkers) => {\n            if (rectIntersection(bunker.getBoundingRect(), aB))\n            {\n                aliens.splice(i, 1);\n                bunker.lives -= 8;\n                if (bunker.lives <= 0)\n                {\n                    bunkers.splice(j, 1);\n                }\n            }\n        });\n    });\n    return gameOver;\n}\n","import {\n  preload,\n  init,\n  update,\n  draw\n} from './game'\n\nconst canvas = document.getElementById(\"cnvs\");\ncanvas.width = window.innerWidth;\ncanvas.height = window.innerHeight;\n\nconst tickLength = 16; //ms\nlet lastTick;\nlet lastRender;\nlet stopCycle;\n\nfunction run(tFrame) {\n    stopCycle = window.requestAnimationFrame(run);\n\n    const nextTick = lastTick + tickLength;\n    let numTicks = 0;\n\n    if (tFrame > nextTick) {\n        const timeSinceTick = tFrame - lastTick;\n        numTicks = Math.floor(timeSinceTick / tickLength);\n    }\n\n    for (let i = 0; i < numTicks; i++) {\n        lastTick = lastTick + tickLength;\n        update(lastTick, stopGame);\n    }\n\n    draw(canvas, tFrame);\n    lastRender = tFrame;\n}\n\nfunction stopGame() {\n    window.cancelAnimationFrame(stopCycle);\n}\n\nfunction onPreloadComplete() {\n  lastTick = performance.now();\n  lastRender = lastTick;\n  stopCycle = null;\n  init(canvas);\n  run();\n}\n\n//setTimeout(() => {  console.log(\"World10!\"); }, 10000);\npreload(onPreloadComplete); // without waiting\n//setTimeout(() => {  preload(onPreloadComplete); }, 69000); // with titles\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}